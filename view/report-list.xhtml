<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
				xmlns:s="http://jboss.com/products/seam/taglib"
				xmlns:ui="http://java.sun.com/jsf/facelets" 
				xmlns:f="http://java.sun.com/jsf/core" 
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:rich="http://richfaces.org/rich"
				xmlns:a="http://richfaces.org/a4j"
				template="layout/template.xhtml">

<ui:define name="title">Reports List</ui:define>

	<ui:define name="data-main-title">#{empty type ? reportListDataPreparator.defaultType() : type} Reports</ui:define>
	<ui:define name="data-main-body">
		<rich:panel>
			<f:facet name="header">List of Reports (#{empty preparedReports ? 0 : (reportList.paginated ? reportList.resultCount : preparedReports.size)})</f:facet>
			<div class="results" id="reportList">

				<h:outputText value="The are no reports." rendered="#{empty preparedReports}" />
				<h:form>
					<rich:dataTable id="reportList" var="_report" value="#{preparedReports}" rendered="#{not empty preparedReports}" rows="20">

						<rich:column sortBy="#{_report.reason}">
							<f:facet name="header">Reason</f:facet>
							<h:outputText value="#{_report.reason}" />
						</rich:column>

						<rich:column sortBy="#{_report.route}">
							<f:facet name="header">Route</f:facet>
							<h:outputText value="#{_report.route}" />
						</rich:column>

						<rich:column sortBy="#{_report.startDate}">
							<f:facet name="header">Start date</f:facet>
							<h:outputText value="#{_report.startDate}">
								<s:convertDateTime type="date" dateStyle="short" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{_report.endDate}">
							<f:facet name="header">End date</f:facet>
							<h:outputText value="#{_report.endDate}">
								<s:convertDateTime type="date" dateStyle="short" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{_report.comment}">
							<f:facet name="header">Comment</f:facet>
							<h:outputText value="#{_report.comment}" />
						</rich:column>

						<rich:column sortBy="#{_report.createdDate}">
							<f:facet name="header">Created date</f:facet>
							<h:outputText value="#{_report.createdDate}">
								<s:convertDateTime type="both" dateStyle="short" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{_report.lastUpdatedDate}">
							<f:facet name="header">Last updated date</f:facet>
							<h:outputText value="#{_report.lastUpdatedDate}">
								<s:convertDateTime type="both" dateStyle="short" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{_report.owner.fullName}">
							<f:facet name="header">Employee</f:facet>
							<h:outputText value="#{_report.owner.fullName}" />
						</rich:column>

						<rich:column sortBy="#{_report.totalAmount}">
							<f:facet name="header">Total amount</f:facet>
							<h:outputText value="#{_report.totalAmount}">
								<f:convertNumber pattern="$#,##0.00" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{_report.totalTaxAmount}">
							<f:facet name="header">Total tax</f:facet>
							<h:outputText value="#{_report.totalTaxAmount}">
								<f:convertNumber pattern="$#,##0.00" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{_report.totalAmountWithoutTax}">
							<f:facet name="header">Total w/o tax</f:facet>
							<h:outputText value="#{_report.totalAmountWithoutTax}">
								<f:convertNumber pattern="$#,##0.00" />
							</h:outputText>
						</rich:column>

						<rich:column sortBy="#{messages[_report.currentStatus.label]}">
							<f:facet name="header">Status</f:facet>
							<h:outputText value="#{messages[_report.currentStatus.label]}" />
						</rich:column>

						<rich:column sortBy="#{_report.reviewer.fullName}">
							<f:facet name="header">Accountant</f:facet>
							<h:outputText value="#{_report.reviewer.fullName}" />
						</rich:column>

						<rich:column styleClass="action">
							<f:facet name="header">Action</f:facet>
							<s:link view="/report-view.xhtml" value="View" id="report-view">
								<f:param name="reportId" value="#{_report.id}" />
							</s:link>
            				#{' '}
            				<s:link view="/report-edit.xhtml" value="Edit" propagation="none" id="report-edit">
								<f:param name="reportId" value="#{_report.id}" />
							</s:link>
						</rich:column>

						<f:facet name="footer">
							<rich:datascroller renderIfSinglePage="false" page="#{reportListDataPreparator.scrollerPage}" />
						</f:facet>
					</rich:dataTable>
				</h:form>
			</div>
		</rich:panel>

	</ui:define>
</ui:composition>
